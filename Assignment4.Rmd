---
title: "Assignment4"
author: "Holly Finertie - HF2379"
date: "Due: 2/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(modelr)
library(mgcv)
set.seed(100)
```

## Part I: Implementing a Simple Prediction Pipeline

### Data Import
I converted categorical variables into factors and cleaned the names. I decided not omit missing values. 

```{r}
nychealth = read_csv("./data/class4_p1.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    chronic1 = as.factor(chronic1), 
    chronic3 = as.factor(chronic3), 
    chronic4 = as.factor(chronic4), 
    tobacco1 = as.factor(tobacco1), 
    alcohol1 = as.factor(alcohol1), 
    habits5 = as.factor(habits5), 
    habits7 = as.factor(habits7), 
    agegroup = as.factor(agegroup),
    dem3 = as.factor(dem3),
    dem4 = as.factor(dem4), 
    dem8 = as.factor(dem8),
    povertygroup = as.factor(povertygroup)
  )

head(nychealth)
```


### Testing and Training Data Sets
Set up a testing and training data set with 70% vs 30%. 
```{r}
train_nychealth = nychealth %>% dplyr::sample_frac(.7)
test_nychealth = dplyr::anti_join(nychealth, train_nychealth, by = 'x1')
```

### (1) Fit Prediction Models Using Training Data Sets

Model1: $$ healthdays = \beta_0 + \beta_1 Chronic1 + \beta_2 Chronic3 + \beta_3 Chronic4 + \beta_4 BMI + \beta_5 Tobacco1 + \beta_6 Alcohol1 + \beta_7 PovertyGroup $$

Model2: $$ healthdays = \beta_0 + \beta_1 Chronic1 + \beta_2 BMI +  \beta_3 PovertyGroup $$
```{r}
model1 = lm(healthydays ~ chronic1 + chronic3 + chronic4 + bmi + tobacco1 + alcohol1 + povertygroup, data = train_nychealth)

model1 %>% broom::tidy() %>% knitr::kable()

model2 = lm(healthydays ~ chronic1 + bmi + povertygroup, data = train_nychealth)

model2 %>% broom::tidy() %>% knitr::kable()
```

### (2) Apply Models to Testing Data Set
Using RMSE as a measure of fit, the first model is the preferred model of prediction. 

Model 1 RMSE = `r round(rmse(model1, test_nychealth), digits = 3)`
Model 2 RMSE = `r round(rmse(model2, test_nychealth), digits = 3)`

```{r}
rmse(model1, test_nychealth)
rmse(model2, test_nychealth)
```

### (3) Implementation of Final Model 

Final Model: $$ healthdays = \beta_0 + \beta_1 Chronic1 + \beta_2 Chronic3 + \beta_3 Chronic4 + \beta_4 BMI + \beta_5 Tobacco1 + \beta_6 Alcohol1 + \beta_7 PovertyGroup $$


## Part II: Conducting an Unsupervised Analysis

### Data Import

```{r}
data("USArrests") 

arrestdata = USArrests %>% 
  janitor::clean_names() %>% 
  drop_na()
```

### Hierarchical Clustering: Agglomeration Method

```{r}
set.seed(100)
# Create Dissimilarity matrix
diss.matrix = dist(arrestdata, method = "euclidean")

# Complete Linkage
complete_link = hclust(diss.matrix, method = "complete")

# Average Linkage 
average_link = hclust(diss.matrix, method = "average")

# Single Linkage
single_link = hclust(diss.matrix, method = "single")

# Plot the obtained dendrogram
plot(complete_link, cex = 0.6, hang = -1)
plot(average_link, cex = 0.6, hang = -1)
plot(single_link, cex = 0.6, hang = -1)

```

